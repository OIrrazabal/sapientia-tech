# Examen Final - Primera Oportunidad

## Condiciones Generales

-   El examen es presencial e individual.
-   Se presenta en la fecha del examen. Deben asistir a firmar acta de asistencia como siempre.
-   Solo pueden rendir alumnos que figuren en acta.
-   Cada alumno tendr√° su repositorio de GitLab propio (creado por el profesor).
-   Solo se corrige lo que est√° en la rama "main".
-   Para actualizar "main" se debe seguir el esquema de trabajo de Merge Request.
-   Fecha tope para solicitar MRs y cambio de c√≥digo:
    -   **El d√≠a del examen hasta el mediod√≠a**
-   El proyecto debe estar en un estado adecuado (se debe poder clonar, instalar y ejecutar) sin tener que realizar ajustes de c√≥digo, de base de datos o modificaciones manuales ni externas.
-   Se debe seguir utilizando las mismas tecnolog√≠as y herramientas utilizadas a lo largo del semestre.
-   Leer y seguir las instrucciones especificadas.
-   En caso de dudas se deben hacer las consultas v√≠a GitLab.
-   Si hay tickets pendientes, o errores acarreados de entregas anteriores, se deben corregir para esta entrega. Estas correcciones no suman puntos al momento del examen, pero en caso de no haberse corregido restaran sobre el total. Especial atenci√≥n a errores de tipo:
    -   base de datos no actualizada correctamente.
    -   enlaces a p√°ginas rotas.
    -   navegaci√≥n incorrecta.
    -   errores de validaci√≥n que no se muestren correctamente en la interfaz.
    -   paquetes o librer√≠as no instaladas o definidas correctamente.
    -   dependencias no actualizadas.
    -   validaciones incompletas (solo front por ejemplo) o incorrectas (ejemplo no normalizar un correo electr√≥nico que permita registrar dos veces el mismo correo pero con diferente "case").
    -   c√≥digo ubicado incorrectamente (ejemplo, consultas SQL fuera de modelos, validaciones mezcladas con l√≥gica, c√≥digo en archivos de rutas).
-   Ser respetuosos de la materia, del profesor y de los compa√±eros no pidiendo excepciones especiales y respetando los tiempos y procesos definidos.

---

## Actividades a implementar (en el repositorio GitLab):

### Dise√±o y Programaci√≥n:

---

#### Item F1 - Env√≠o de correo - 5 puntos

-   [ ] Implementar el env√≠o de correos a un profesor, cuando es asignado como profesor de un curso.
-   [ ] Debe utilizarse [MailTrap](https://mailtrap.io/es/) para validar el env√≠o de correos sin necesidad de un servidor especial.
-   [ ] Utilizar una plantilla adecuada (no simplemente un texto gen√©rico).
-   [ ] Seguir los lineamientos en clase para el uso de valores confidenciales en el proyecto y el Git.
-   El correo debe mostrar:

    -   [ ] el nombre y logo usado en su Web
    -   [ ] Informaci√≥n del profesor
    -   Informaci√≥n del curso:

        -   [ ] Nombre Categor√≠a
        -   [ ] Nombre Curso
        -   [ ] Imagen de Portada

---

#### Item F2 - Archivos de Video

-   Subir videos en Secciones de un Curso - 4 puntos:
    -   [ ] Permitir que el profesor de un curso pueda adjuntar un archivo de video a una secci√≥n
            nueva (upload), de forma opcional, al momento de crear la secci√≥n.
    -   [ ] Validar la extensi√≥n del archivo. Definir 2 extensiones que permitir√° su app. Mencionarlas en la documentaci√≥n.
    -   [ ] Los videos deben subirse dentro de la carpeta:
            `/assets/videos/{idCurso}/{idSeccion}/{nombreOriginalVideo.extensi√≥n}`
    -   [ ] En el caso de subir dos veces un mismo video (mismo nombre) a una secci√≥n,
            emitir un error "amigable" adecuado de validaci√≥n en pantalla.
    -   [ ] Se debe validar la extensi√≥n m√°xima del video (tama√±o) a 3MB.
    -   [ ] Ning√∫n archivo de video, existente o futuro, deber√° "trackearse" en el repo Git.
-   Ver Stream de videos en Secciones - 4 puntos:
    -   [ ] En las p√°ginas de Ver Curso, si una
            secci√≥n tiene un video asociado debe poder visualizarse desde la secci√≥n.
    -   [ ] El video debe visualizarse como un stream (**no una descarga**) dentro de la vista del curso
            asociado a la secci√≥n donde fue subido. No utilizar una p√°gina externa.
    -   [ ] Asegurarse de incluir en la documentaci√≥n una captura de ejemplo de como se debe visualizar dentro de su p√°gina, as√≠ como un ejemplo donde encontrar esta visualizaci√≥n.
    -   [ ] El video solo debe ser visible para usuarios que son alumnos o profesores del curso donde fueron subidos.

---

#### Item F3 - Rutas de Aprendizaje

-   Ruta de aprendizaje - Admin - 5 puntos:
    -   [ ] En el men√∫ de Administrador agregar una opci√≥n para manejar (crear, editar, listar) "Rutas de Aprendizaje".
    -   [ ] Una "Ruta de Aprendizaje" debe tener un nombre, y adem√°s debe poder agregarse uno o m√°s cursos a esta.
    -   [ ] Un ejemplo podr√≠a ser una "Ruta" llamada "FullStack" y que contenga varios cursos. Pueden ser
            de la misma o distinta categor√≠a.
    -   [ ] Las "rutas", dentro del m√≥dulo de administrador, deben poder crearse con un nombre obligatoriamente. Aplicar validaci√≥n.
    -   [ ] Al editar una "ruta" debe mostrar los cursos que tenga agregado, as√≠ como permitir agregar uno o m√°s adicionalmente en cualquier momento.
    -   [ ] Claramente, si podemos agregar un curso, debemos poder removerlo de la "ruta" en caso que lo hayamos
            agregado incorrectamente.
    -   [ ] Un curso solo debe poder estar dentro de una ruta, no puede estar en m√°s de una, al mismo tiempo.
-   Ver Ruta de Aprendizaje - 2 puntos:
    -   [ ] Actualizar las vistas de Ver Curso para mostrar el nombre de la "ruta" de un curso, en caso de que la tenga.

---

#### Item F4 - Correlatividades

-   Correlatividades - Creaci√≥n - 5 puntos:

    Solo dentro de una ruta de aprendizaje, se deben poder definir cursos correlativos.
    Un curso correlativo implica que el alumno debe estar inscripto como alumno en la correlativa previa para inscribirse al curso.

    Ejemplo, si IS3 se registra como requisito correlativo de IS4, solo los alumnos que est√°n inscriptos en IS3 pueden autoinscribirse a IS4.

    -   [ ] Un curso puede tener cero, uno o muchos cursos correlativos previos, pero solo de cursos que formen parte de la misma ruta.
    -   [ ] Un curso que no forme parte de ninguna ruta, no puede tener correlativas.
    -   [ ] Se debe validar que un curso no se pueda registrar m√°s de una vez como
            correlativo de otro (es decir, IS3 -> IS4 no deber√≠a poder registrarse dos veces).
    -   [ ] Se debe poder eliminar una correlativa en cualquier momento.
    -   [ ] Utilizar elementos adecuados para editar cursos y correlativas dentro de una ruta.
    -   [ ] Especial atenci√≥n al remover un curso de una "ruta" solicitado previamente. Se debe validar que no tenga una correlativa antes de hacerlo.

-   Correlatividades - AutoInscripci√≥n - 5 puntos:
    -   [ ] Implementar el control de cursos correlativos al momento de autoinscribirse un alumno a un curso.
    -   [ ] El control solo debe ser aplicado en la auto-inscripci√≥n de un usuario como alumno de
            un curso.
    -   [ ] Si el admin inscribe a un alumno, no debe aplicarse el control.
    -   [ ] En caso de error de validaci√≥n, se debe mostrar un error adecuado en pantalla indicando cu√°l(es) cursos correlativos est√° incumpliendo.
    -   [ ] En caso que un curso tenga muchas correlativas, se deben cumplir todas para permitir la inscripci√≥n.

---

### Testing:

-   Test de Interfaz - 5 puntos:
    Crear un test de interfaz utilizando Playwright.
    -   [ ] El test debe ser ejecutado en el navegador Mozilla √∫nicamente.
    -   [ ] Debe mostrarse la ejecuci√≥n en el modo gr√°fico.
    -   El test debe:
        -   [ ] Autoregistrar un usuario. Utilizar un diccionario o generador de correos y datos para que cada ejecuci√≥n inserte un nuevo usuario sin repetir datos. Puede definir valores aleatorios adecuados para cada campo. Imprimir en la consola los valores al iniciar la ejecuci√≥n. El password siempre ser√° el valor utilizado de pruebas en el semestre.
        -   [ ] Hacer login con el usuario
        -   [ ] Validar carga correctamente su p√°gina "home".
        -   [ ] Inscribirse a un curso al cu√°l no sea posible por correlatividad.
        -   [ ] Validar el error en base a un elemento visible en pantalla. El curso debe estar definido "en duro" en la prueba. Se debe generar una captura de pantalla en este punto autom√°tico en el test.
        -   [ ] Inscribirse a un curso al cu√°l si sea posible por correlatividad.
        -   [ ] Validar el exito en base a un elemento visible en pantalla. El curso debe estar definido "en duro" en la prueba. Se debe generar una captura de pantalla en este punto autom√°tico en el test.
    -   Debe poder ejecutarse con un comando el cu√°l debe permitir la ejecuci√≥n del proceso completo.
    -   Documentar el comando de forma visible y entendible (como texto) en la documentaci√≥n.
    -   Mostrar la salida con capturas en la documentaci√≥n.

## ‚ö° Resumen Ejecutivo - Test de Interfaz

### Comando √∫nico para ejecutar el test completo:

```bash
# 1. Configuraci√≥n (solo primera vez)
npm run test:e2e:setup

# 2. Iniciar servidor (mantener abierto)
npm run dev

# 3. Ejecutar test (en nueva terminal)
npm run test:e2e
```

### ‚úÖ Validaciones automatizadas:
- üé≤ Generaci√≥n de usuario √∫nico con datos aleatorios
- üîê Login autom√°tico con usuario creado  
- üè† Validaci√≥n del home autenticado
- ‚ùå Error de correlatividades (curso con dependencias)
- ‚úÖ Inscripci√≥n exitosa (curso sin dependencias)  
- üì∏ Capturas autom√°ticas en puntos cr√≠ticos

### üì∏ Capturas generadas:
- `test/screenshots/error-correlatividades.png`
- `test/screenshots/inscripcion-exitosa.png`
- `test/screenshots/test-final-state.png`

### üîç Ver resultados:
```bash
npx playwright show-report
```

---

## Test de Interfaz E2E con Playwright

### Descripci√≥n

El proyecto incluye un test automatizado de interfaz usando **Playwright** que valida el flujo completo de correlatividades en el sistema. El test ejecuta los siguientes pasos:

1. **Autoregistro de usuario** con datos aleatorios √∫nicos
2. **Login** con el usuario creado
3. **Validaci√≥n del home** de usuario autenticado
4. **Intento de inscripci√≥n** a curso con correlatividades (debe fallar)
5. **Inscripci√≥n exitosa** a curso sin correlatividades
6. **Capturas autom√°ticas** en puntos cr√≠ticos

### Configuraci√≥n

El test est√° configurado para ejecutarse en **Firefox en modo headed** (ventana visible) como se requiere en el examen.

#### Archivos del test:
- `test/e2e/correlatividades.spec.js` - Test principal
- `test/e2e/test-simple.spec.js` - Test simplificado alternativo  
- `test/e2e/helpers/testDataGenerator.js` - Generador de datos de prueba
- `playwright.config.js` - Configuraci√≥n de Playwright
- `test/screenshots/` - Directorio de capturas autom√°ticas

### Comandos para ejecutar el test

#### 1. Configuraci√≥n inicial (solo la primera vez):
```bash
npm run test:e2e:setup
```

Este comando:
- Instala las dependencias necesarias
- Descarga Firefox para Playwright

#### 2. Ejecutar el test:
```bash
npm run test:e2e
```

**¬°IMPORTANTE!** Antes de ejecutar el test, asegurarse de que el servidor est√© ejecut√°ndose:
```bash
npm run dev
```

### Generaci√≥n de datos aleatorios

El test genera autom√°ticamente datos √∫nicos para cada ejecuci√≥n:

```javascript
// Ejemplo de datos generados:
üë§ Nombre: Usuario Test 8473
üìß Email: test.usuario.1672531234567@mailtest.com  
üì± Tel√©fono: 098765432
üè† Direcci√≥n: Calle Test 8473, Ciudad Test
üîë Password: test123 (fijo como se requiere)
```

### Cursos utilizados en el test

El test utiliza cursos espec√≠ficos definidos "en duro":

- **Curso con correlatividades**: JavaScript Avanzado (ID: 4)
  - URL: `/auth/curso/4`
  - Debe fallar la inscripci√≥n y mostrar error

- **Curso sin correlatividades**: HTML B√°sico (ID: 1)  
  - URL: `/auth/curso/1`
  - Debe permitir inscripci√≥n exitosa

### Capturas autom√°ticas

El test genera autom√°ticamente las siguientes capturas en `test/screenshots/`:

1. **error-correlatividades.png** - Error al intentar inscripci√≥n con correlatividades
2. **inscripcion-exitosa.png** - √âxito en inscripci√≥n sin correlatividades  
3. **test-final-state.png** - Estado final del test

### Salida ejemplo del test

```
üöÄ Iniciando test de correlatividades...
============================== 
üìã DATOS DE USUARIO GENERADOS PARA EL TEST:
==============================
üë§ Nombre: Usuario Test 8473
üìß Email: test.usuario.1672531234567@mailtest.com
üì± Tel√©fono: 098765432
üè† Direcci√≥n: Calle Test 8473, Ciudad Test  
üîë Password: test123
üïê Timestamp: 1672531234567
üé≤ Random ID: 8473
==============================
‚úÖ Home de usuario autenticado cargado correctamente
‚úÖ Error de correlatividades mostrado correctamente
üì∏ Captura del error guardada en: test/screenshots/error-correlatividades.png
‚úÖ Inscripci√≥n exitosa
üì∏ Captura del √©xito guardada en: test/screenshots/inscripcion-exitosa.png
üèÅ Test completado exitosamente
üìä Usuario de prueba: test.usuario.1672531234567@mailtest.com
üìÅ Capturas guardadas en: test/screenshots/
```

### Reporte HTML

Despu√©s de ejecutar el test, se puede ver un reporte detallado con:
```bash
npx playwright show-report
```

---

### Documentaci√≥n:

-   Wiki - 5 puntos

    En un proceso de desarrollo de Software, la documentaci√≥n es clave. Para esta entrega
    tendr√°n que leer e investigar como utilizar la Wiki del GitLab para documentar su proyecto. Deber√°n:

    -   [ ] Crear una p√°gina principal en la Wiki de su proyecto.
    -   [ ] Crear una subp√°gina en la Wiki por cada item solicitado dentro de este examen. Lease,
            si hay 3 requerimientos a implementar, deber√≠an haber 3 subp√°ginas dentro de la Wiki.
    -   Dentro de cada p√°gina de ticket deber√°n indicar los cambios realizados a nivel de usando la siguiente plantilla:

        -   Una o m√°s capturas de la implementaci√≥n
        -   Descripci√≥n u observaciones. Texto libre para indicar brevemente que
            implic√≥ la implementaci√≥n o modificaci√≥n realizada.
        -   Base de datos. √ânfasis en ajustes realizados con capturas de estas modificaciones con capturas de las modificaciones.
        -   Rutas: Creadas
        -   Modelos: Nuevos o modificados.
        -   Controlador: Nuevos o modificados.
        -   Validaciones y como se muestran. Qu√© validaciones ha implementado, en front o back,
            como se muestra un error de validaci√≥n en pantalla (captura).
        -   Interfaz y estilos de presentaci√≥n
        -   Comandos (por ejemplo comandos a ejecutar en terminal)

    -   Cada secci√≥n deber√° tener un t√≠tulo y su desarrollo.
    -   Cada secci√≥n que no aplique deber√° tener el texto "N/A". Es decir, si el requerimiento item
        #F1 (ejemplo) no tuvo modificaciones en la base de datos, no se elimina la secci√≥n, sino simplemente se define como su contenido "N/A".
    -   En la p√°gina principal de la Wiki agregar el DER completo de su aplicaci√≥n, as√≠ como una breve descripci√≥n del trabajo realizado.

    -   Agregar en el footer de la App Web un enlace para llegar directamente a la p√°gina
        principal de la documentaci√≥n. Este enlace deber√° estar visible
        en todos los footers de la app, en caso de tener m√°s de uno.

    -   Se evaluar√°:

        -   Correctitud: Lo que se ve en la Wiki representa la versi√≥n entregada del c√≥digo, y viceversa. 2,5 puntos
        -   Presentaci√≥n: Elementos solicitados est√°n presentes en la Wiki. Presentaci√≥n adecuada
            de elementos en la Wiki (t√≠tulos utilizando elementos de t√≠tulos, p√°rrafos, im√°genes
            son visibiles y entendibles, ortograf√≠a, coherencia entre el texto y las secciones). 2,5 puntos

        Para tener el puntaje total adem√°s se deben documentar todas las funcionalidades solicitadas correctamente.

---
