<!-- Navbar Start -->
<nav class="navbar navbar-expand-lg bg-white navbar-light shadow sticky-top p-0">
    <a href="<%= usuario ? '/auth/home' : '/' %>" class="navbar-brand d-flex align-items-center px-4 px-lg-5">
        <img src="/assets/img/aplicacion.jpg" alt="Sapientia Tech Courses Logo" style="height: 40px; width: auto;" class="me-2">
        <h2 class="m-0 text-primary"><%= appName %></h2>
    </a>
    <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
        <div class="navbar-nav ms-auto p-4 p-lg-0">
            <a href="<%= usuario ? (usuario.es_admin === 1 ? '/admin/home' : '/auth/home') : '/' %>" class="nav-item nav-link active">Inicio</a>
            <a href="/public/about" class="nav-item nav-link">Acerca De</a>
            <div class="nav-item dropdown">
                <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Cursos</a>
                <div class="dropdown-menu fade-down m-0">
                    <a href="/auth/mis-cursos-redirect" class="dropdown-item">Mis cursos</a>
                    <a href="/auth/buscar" class="dropdown-item">Buscar cursos</a>
                </div>
            </div>
            <div class="nav-item dropdown">
                <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pagina</a>
                <div class="dropdown-menu fade-down m-0">
                    <a href="/public/team" class="dropdown-item">Equipo</a>
                    <a href="/public/profesores" class="dropdown-item">Profesores</a>
                    <a href="/public/testimonial" class="dropdown-item">Testimonial</a>
                    <a href="/404" class="dropdown-item">404 Page</a>
                </div>
            </div>
            <a href="/public/contact" class="nav-item nav-link">Contactos</a>
        </div>

        <% if (typeof usuario !== 'undefined' && usuario) { %>
            <div class="d-flex align-items-center">
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle d-flex align-items-center text-primary" data-bs-toggle="dropdown">
                        <img src="/assets/profile/<%= usuario.foto_perfil || 'default.jpg' %>?v=<%= new Date().getTime() %>"
                             alt="<%= usuario.nombre %>"
                             class="rounded-circle me-2"
                             style="width: 32px; height: 32px; object-fit: cover;"
                             onerror="this.onerror=null;this.src='/assets/profile/default.jpg?v=' + new Date().getTime();">
                        <span><%= usuario.nombre %></span>
                    </a>
                    <div class="dropdown-menu fade-down m-0">
                        <a href="/auth/perfil" class="dropdown-item">
                            <i class="fa fa-user me-2"></i>Mis Datos
                        </a>
                        <a href="/auth/mis-cursos" class="dropdown-item">
                            <i class="fa fa-book me-2"></i>Mis Cursos
                        </a>
                        <% if (!usuario.es_admin) { %>
                            <form action="/auth/dar-de-baja" method="POST" onsubmit="return confirm('¿Estás seguro que querés darte de baja? Esta acción es irreversible.')">
                                <button type="submit" class="dropdown-item text-danger">
                                    <i class="fa fa-user-slash me-2"></i>Dar de baja
                                </button>
                            </form>
                        <% } %>
                        <a href="/auth/logout" class="dropdown-item">
                            <i class="fa fa-sign-out me-2"></i>Cerrar Sesión
                        </a>
                    </div>
                </div>
            </div>
        <% } else { %>
            <% if (typeof alerta !== 'undefined' && alerta) { %>
                <div class="alert alert-warning alert-dismissible fade show mb-2" role="alert" style="position:absolute;right:20px;top:70px;z-index:2000;min-width:250px;">
                    <%= alerta %>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                </div>
            <% } %>
            <div class="nav-item dropdown d-none d-lg-block">
                <button class="btn btn-primary py-4 px-lg-5 dropdown-toggle" data-bs-toggle="dropdown">
                    ACCEDER<i class="fa fa-arrow-right ms-3"></i>
                </button>
                <div class="dropdown-menu fade-down m-0">
                    <a href="/public/login" class="dropdown-item">
                        <i class="fa fa-user me-2"></i>Login Usuario
                    </a>
                    <a href="/public/admin-login" class="dropdown-item">
                        <i class="fa fa-lock me-2"></i>Login Admin
                    </a>
                </div>
            </div>
        <% } %>
    </div>
</nav>
<!-- Navbar End -->
